# 常用资源

## 如何从官网下载 Google Chrome 离线安装包

1、打开 Chrome 浏览器主页：<http://www.google.cn/chrome>

2、地址栏最后的网址是这样的：<http://www.google.cn/chrome/browser/desktop/index.html>

3、在网址最后加上：?standalone=1&platform=win64，回车键后打开的是 64位下载页面，点击“下载Chrome”按钮，得到的就是 Google Chrome 64位离线安装包

解释下添加的参数，?standalone=1 指离线安装包，platform=win64 指64位Windows 版本。

如果加上的只是“?standalone=1”可以用来下载32位的Chrome离线包。用“mac”替换“win”，就可以下载 Mac 版本的了。

    ————————————————
    版权声明：本文为CSDN博主「hailangnet」的原创文章，遵循CC 4.0 BY-SA版权协议，转载请附上原文出处链接及本声明。
    原文链接：https://blog.csdn.net/hailangnet/article/details/51704034

    https://www.google.cn/chrome/thank-you.html?platform=win64&standalone=1&statcb=1&installdataindex=defaultbrowser&defaultbrowser=1

    https://www.google.com/intl/zh-CN/chrome/thank-you.html?statcb=1&installdataindex=empty&standalone=1&platform=win64

## Nvidia显卡驱动下载

官网目前只提供dch驱动，老版本windows（含老版本win10）的standard藏起来了，在这里搜索：

    https://www.nvidia.cn/Download/Find.aspx?lang=cn

根据具体游戏名称搜索对应驱动 <https://nvidia.custhelp.com/app/home/>

## windows 10 / windows 11安装的那些事儿

### 关键词 GPT/MBR、UEFI/CSM

硬盘分区类型 GPT/MBR:

    MBR是windows 10/7之前老的硬盘分区方式， GPT是win7之后新的硬盘分区方式，使用不同的硬盘分区类型，windows引导启动的方式是不同的。在Windows安装时，有个步骤是划分硬盘分区，自动使用的是GPT方式，默认把启动硬盘上划分了3个分区（如果是一块新的未划分分区的硬盘），其中两个特殊的小分区在windows安装完成后默认是隐藏看不到的。所以如果只想用一个分区，需要提前把硬盘挂到别的电脑上用windows管理或其他软件分区，明确选择类型为MBR，或者用diskpart命令行。

目标系统类型 UEFI/CSM

    UEFI是windows 7 之后出现的新型启动引导方式，跳过很多硬件自检，加速了开机步骤，缺点是跟之前的windows系统启动过程不兼容。在windows安装之前，需要在主板的BIOS设置中，明确开启UEFI选项。为区别于新式的UEFI，主板BIOS设置中提供了兼容老的启动方式的选项：CSM，适用于不兼容UEFI方式启动的老显卡等设备能正常的显示。有些如 nvidia gtx 1080 时代的显卡，用 HDMI 口可以兼容UEFI方式，而 DP 口则不兼容，需要根据连接该口开机后显示器是否出现画面来设置BIOS的上述选项。

    UEFI要记得确认下主板BIOS的“settings”选项，“SATA And RST configuration”的选项，硬盘模式为“AHCI”

### 老显卡不支持DP口开机显示（Nvidia Geforce 1080系）

#### 一劳永逸方案：Nvidia 显卡可以升级固件解决这个问题

先把显卡挂到别的能显示的机器上（或先连接HDMI口安装windows能进入系统后），升级下固件，以后就可以实现连接DP口安装 windows 10 了

    <https://www.tenforums.com/graphic-cards/144258-latest-nvidia-geforce-graphics-drivers-windows-10-2-a.html>
        <https://www.tenforums.com/windows-10-news/111671-nvidia-graphics-firmware-update-tool-displayport-1-3-1-4-a.html>
            Geforce 1080系 <https://www.nvidia.com/en-us/drivers/nv-uefi-update-x64/>
            Geforce 3080系 <https://nvidia.custhelp.com/app/answers/detail/a_id/5233/>

#### 简单方案：连接HDMI口安装windows就行了

主板BIOS设置为 GPT+UEFI 的情况下只能连接HDMI口安装系统

新出技嘉主板的BIOS设置中，默认BOOT选项采用的是GPT分区+UEFI引导，这样的启动u盘注意选择对应模式才能顺利启动，而且这样的BIOS设置才符合windows 11的安装要求。

用Rufus制作windows 10安装u盘，选择分区类型是GPT（右侧的选项自动选择“UEFI(非CSM)”，估计是UEFI也有版本更替）而不能是MBR，这样的启动u盘才能顺利启动。有些如 nvidia gtx 1080 时代的显卡，连接 HDMI 口可以兼容UEFI方式，而 DP 口则不兼容，这样制作的安装u盘可以启动系统但是DP口在开机的时候不显示，只能连接HDMI口安装系统。

#### 凑合方案：主板BIOS设置为 CSM 方式安装 windows 可以连接DP口

用Rufus制作windows 10安装u盘，如果分区类型选择MBR（右侧选项自动选择“BIOS+UEFI(CSM)”），则也只能连接HDMI口安装系统。这时如果想使用DP口开机显示，则主板BIOS要更改设置，CSM Support（Windows 10之前windows版本安装的兼容模式，事关识别usb键盘鼠标和UEFI显卡）要选“Enable”，并设置兼容模式：

    重启开机后按 F2 进入bios，选BOOT选项卡，找到 Window 10 Features，选“other os”

    之后下面出现了 CSM Support， 选“Enable”，
    之后下面出现的三项，除了网卡的那个，其它两个选UEFI，在“other os”模式下可以实现DP口的开机显示。

关于主板BIOS设置CSM方式可以启动DP口的解释 <https://nvidia.custhelp.com/app/answers/detail/a_id/3156/kw/doom/related/1>

### 用Rufus制作启动u盘安装 windows11

WIN11除了硬件要求之外，还有2个必要条件：

    1. 主板BIOS开启 TPM2.0

    2. 主板BIOS开启安全启动（Secure Boot），

这样在用Rufus制作启动u盘时，分区类型要选择GPT（这时目标系统类型自动选择UEFI），这样的开机过程直接可以跳过BIOS自检等一堆耗时过程，秒进桌面。

一、根据Rufus的要求 <https://github.com/pbatard/Rufus/wiki/FAQ#Windows_11_and_Secure_Boot>，Rufus 3.17版之前制作的启动u盘，初始引导启动需要临时关闭“Secure Boot”：

    开机 F2 进入bios，选BOOT选项卡，找到 Windows 10 Features 设置为 other os

    之后下面出现了 CSM Support， 选 Enable，
    之后下面出现的三项，除了网卡的那个，其它两个选UEFI

    用Rufus制作的启动u盘（制作时的选项是“分区类型GPT+目标系统类型UEFI”）启动计算机，windows安装程序自动启动，按提示点选下一步，注意原硬盘分区建议全删，这时windows安装程序开始拷贝文件，并未实质进入配置计算机硬件系统的过程，这时的windows安装过程并不要求Secure Boot。

注：觉得Secure Boot关闭就不安全了？ 不，它本来就不是什么安全措施，只是名字叫安全，其实做的工作就是数字签名验证，而且微软的密钥已经在2016年就泄露了…… 参见<https://github.com/pbatard/Rufus/wiki/FAQ#Why_do_I_need_to_disable_Secure_Boot_to_use_UEFINTFS>。至于linux，没参与微软的这个步骤的话，主板厂商不会内置它的公钥到主板中，估计安装的时候就不能开启这个选项。

二、在windows安装程序拷贝完文件，提示进行第一次重启的时候，打开BIOS的“Secure Boot”选项：

    重启后按 F2 进入bios设置，选BOOT选项卡，找到 Windows 10 Features 设置为 “windows 10”

    之后下面的选项“CSM Support”会消失，故其原来设置的 Disabled 或 Enable 没啥用了，同时下面的三个选项也会消失，都不需要了

    之后下面出现的是“Secure Boot”选项，选择Enable，按 F10 保存退出，主板重启后自动引导硬盘上的windows安装程序进行后续的安装配置工作

    注意：主板BIOS的选项 Windows 10 feature 设置为“win10”后，原来用MBR方式安装的win7或win10就进不了系统了，除非还原为“other os”

### 使用 Rufus 制作ghost启动盘

引导类型选择FreeDos制作就行了，然后把ghost拷贝到u盘上即可。

<https://qastack.cn/superuser/1228136/what-version-of-ms-dos-does-rufus-use-to-make-bootable-usbs>

### 技嘉 B650M pro 主板BIOS打开网络唤醒功能

根据产品规格指出，此产品有提供网络唤醒 (Wake On LAN) 的功能，但是找不到相关设定或是开关可以启用该选项。

首先，请在开机时进入 BIOS 设定程序，在电源管理选项中，请启用 PME EVENT WAKEUP 功能，然后储存设定退出程序，再重新启动进入 Windows 后，请开启设备管理器窗口，检查网络卡内容并开启唤醒功能相关设定即可。
如果使用的网络卡上有 WOL 接头，需配合主板上 WOL 接头；如果使用的网络卡上没有 WOL 接头，且它的规格是 PCI 2.3，则依上述的方法即可。

<https://www.gigabyte.cn/Motherboard/B560M-AORUS-PRO-rev-10/support#support-dl-driver>

### 刚装完 Windows 10 后的一些设置

先激活

windows安装后，先把电源计划调整为“高性能”，省的它各种睡眠。

关闭windows搜索，这玩意非常没用，但是总是在闲时扫描硬盘，太浪费硬盘和电了。

设置：设备->自动播放->关闭自动运行。

设置：隐私策略各种关闭，有空的时候挨个琢磨吧

设置：打开Windows安全中心
    ->应用和浏览器控制，打开“隔离浏览（WDAG）” <https://docs.microsoft.com/zh-cn/windows/security/threat-protection/microsoft-defender-application-guard/install-md-app-guard>

    ->设备安全性->内核隔离，手动开启“核心隔离”、“内存完整性”  <https://support.microsoft.com/zh-cn/windows/afa11526-de57-b1c5-599f-3a4c6a61c5e2> <https://go.microsoft.com/fwlink/?linkid=866348>

#### 默认键盘设置为英文

中文版 windows 10 默认唯一键盘是中文，而且中文键盘的默认输入法是微软拼音的中文状态。原 windows 7 之前“Ctrl+空格”切换中英文的热键被微软拼音输入法使用了，而且按shift键就切换中英文，默认还是各个应用的窗口统一使用的。其实windows桌面/资源管理器/炒股/游戏等软件的默认状态是响应英文输入，仅对文本编辑软件才应该默认用中文输入。如果只有默认的中文键盘，则微软拼音输入法按一下shift键，中英文状态就切换，非常容易误触。在实际使用中，各个软件窗口一变，或者输入个符号按个shift键，微软拼音输入法就得来回切换中英文，非常非常非常的繁琐。尤其在有些游戏中，一按shift就切出来中文输入法，再按asdf就变成打字到中文输入法的输入栏了。

所以需要再添加一个“英文键盘”，使用它的英文输入法状态，并把这个键盘作为默认状态才对。两种键盘间切换使用热键“Win+空格”。这样做的好处是，切换键盘的同时中英文输入法也跟着切换了（不需要依赖在中文键盘下微软拼音输入法的shift键切换），而且不同的窗口还可以选择记住不同的输入法状态，非常方便。

设置->搜索“语言”，选择"英语"，添加确认，注意取消选择“设置为默认的界面语言”。

设置->搜索“keyboard”，打开“高级键盘设置”，操作如下步骤：

    替换默认输入法，选择“英语”，而不是微软拼音输入法。这样对windows桌面/资源管理器/炒股/游戏等软件的默认状态是英文按键的正确状态。

    勾选“允许我为每个应用窗口使用不同的输入法”，这个非常重要，可以实现有的窗口是英文键盘状态，有的编辑软件窗口保持是切换到中文键盘的状态。

    注意这两种键盘的切换热键是“Win+空格”，以后中英文输入的切换就切换键盘就行了，除非中文输入状态下临时输入英文按下shift键切换。

    取消勾选“使用桌面语言栏”，这个也很重要，某些全屏HDR游戏不兼容这个工具栏，一旦出来输入法条，显示器的HDR状态就跟着来回切换……

    选择“语言栏选项”，勾选“在任务栏中显示其他语言栏图标”，方便鼠标点选切换中英文键盘。

    选择“语言栏选项”，点击“高级键设置”：在“输入语言的热键”列表，点击“输入法/非输入法切换  Ctrl+空格”，点击“更改按键顺序”，取消勾选“启用按键顺序”可以禁用微软拼音输入法的中英文切换使用此按键，因为现在用shift键就够了。

#### 关闭Windows自带的压缩文件夹（zip folder）

从 Windows XP 开始，之后的每一代操作系统（如 Vista、7、8、10），都有一个默认开启的功能：能将压缩文件当作普通文件夹来管理。

在资源管理器左侧的文件夹树视图中，展开一个包含压缩文件（zip 或 cab 格式）的文件夹时，就能看见这些压缩文件如同普通的子文件夹一样，可以直接展开。展开它们，就能很方便地浏览压缩文件中所有文件的信息，同时还能方便地解压。

但是一般用户通常都有自己喜爱的压缩软件，例如 WinRAR、7-Zip 等，他们往往不常使用系统自带的这个压缩文件管理方式，更倾向于使用压缩软件提供的右键菜单功能来压缩或解压文件。而且还会抱怨系统自带的压缩文件夹功 能消耗系统资源，每次打开文件夹时的延迟更让人觉得系统变得缓慢。

Windows XP关闭 zip folder 功能

    打开命令提示符窗口，输入“regsvr32 /u %windir%\system32\zipfldr.dll” （不含引号），回车后提示成功即可关闭。

    开启功能：
    打开命令提示符窗口，输入“regsvr32 %windir%\system32\zipfldr.dll”（不含引号），回车后提示成功即可打开。

提示：以上操作可能只关闭了 ZIP 文件的文件夹显示，可能 CAB 文件没有关闭。未测试。

Windows Vista、7、8、10关闭 zip folder 功能

需要删除或更名两个注册表键：

对于 ZIP 文件：HKEY_CLASSES_ROOT\CLSID\{E88DCCE0-B7B3-11d1-A9F0-00AA0060FA31}

对于 CAB 文件：HKEY_CLASSES_ROOT\CLSID\{0CD7A5C0-9F37-11CE-AE65-08002B2E1262}

由于涉及到权限问题，无法直接删除，需按照以下步骤来操作：（注册表操作有风险，要小心谨慎，并切记要备份。）

    按 Win-R，在运行窗口输入“regedit” 并回车，打开注册表编辑器。

    找到要操作的第一个注册表键 HKEY_CLASSES_ROOT\CLSID\{E88DCCE0-B7B3-11d1-A9F0-00AA0060FA31}

    右键单击它，从弹出菜单中单击“导出(E)”，将该注册表键的原始信息备份到安全位置，以便遇到不测时恢复。

    导出备份完成后，再右键单击该键，从弹出菜单中单击“权限(P)...”

    单击“高级(V)”按钮

    单击“所有者”选项卡

    在“将所有者更改为(O):”框中，选中你当前的用户名

    勾选“替换子容器和对象的所有者(R)”

    单击“应用(A)”按钮

    单击“确定”

    在“安全”选项卡下，在上框中选中你的用户名，然后 在下框中勾选“完全控制”的“允许”

    单击“应用(A)”和“确定”按钮

    现在，你可以自由选择删除或重命名这个注册表键了。注意：请确定你在正确的注册表键上操作！

    好，重复以上步骤来为 第二个注册表键进行重命名或删除。

    重启计算机，压缩文件夹是不是都消失啦？

开启功能：

恢复的话，只需将关闭时建立的两个备份文件导入注册表，重启即可。万一备份不见了，可以从另外的电脑中导出，当然前题是操作系统的版本要一致。

#### 切换黑暗模式（夜间模式）

设置->系统->显示：选择打开“夜间模式”，windows只是把色温降成黄色，显示器亮度还是很晃眼。

设置->轻松使用->颜色滤镜：选择“打开颜色滤镜”，选择“灰度”按钮，显示器变成黑白效果，失去了彩色，也不舒服。

设置->个性化->颜色：下面有个“更多选项”，对“选择默认应用模式”选择“暗”，整个windows的配色方案都变成了暗色，各个软件窗口也跟着变了。这个办法最舒服，白天切换回去也很方便。写到注册表里，在桌面点击右键实现方便切换：

Add_App_Mode_to_desktop_context_menu.reg

    Windows Registry Editor Version 5.00

    ; Created by: Shawn Brink
    ; Created on: September 3rd 2017
    ; Tutorial: https://www.tenforums.com/tutorials/92740-add-app-mode-context-menu-light-dark-theme-windows-10-a.html
    ; Tutorial: https://www.tenforums.com/tutorials/24038-change-default-app-mode-light-dark-theme-windows-10-a.html

    [HKEY_CLASSES_ROOT\DesktopBackground\Shell\AppMode]
    "Icon"="themecpl.dll,-1"
    "MUIVerb"="App mode"
    "Position"="Bottom"
    "SubCommands"=""

    [HKEY_CLASSES_ROOT\DesktopBackground\Shell\AppMode\shell\001flyout]
    "MUIVerb"="Light theme"
    "Icon"="imageres.dll,-5411"

    [HKEY_CLASSES_ROOT\DesktopBackground\Shell\AppMode\shell\001flyout\command]
    @="Reg Add HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Themes\\Personalize /v AppsUseLightTheme /t REG_DWORD /d 1 /f"

    [HKEY_CLASSES_ROOT\DesktopBackground\Shell\AppMode\shell\002flyout]
    "Icon"="imageres.dll,-5412"
    "MUIVerb"="Dark theme"

    [HKEY_CLASSES_ROOT\DesktopBackground\Shell\AppMode\shell\002flyout\command]
    @="Reg Add HKCU\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Themes\\Personalize /v AppsUseLightTheme /t REG_DWORD /d 0 /f"

edge浏览器->设置->外观->整体外观：选择“系统默认”则跟随windows系统的主题颜色变换，也可单独选择“浅色”或“深色”，缺点是仅窗口标签外观变换。如果需要对网页内容开启夜间模式，需要强制开启：

        在浏览器地址栏输入edge://flags/

        在搜索栏输入“Force Dark Mode for Web Contents”

        选择enable，点击选择重启浏览器，除图片以外的所有部分进入夜间模式

#### 关闭附件管理器检查

为什么要关闭？ 浏览器我正常下载的没签名的文件，在有些软件调用的时候就打不开，也没有任何提示，总是报错，让人抓狂。
之前遇到过技嘉制作u盘启动的工具，添加了下载的zip文件，总是制作失败，直到把下载的文件点击右键，选择属性，勾选解除限制，才能正常读取。整个过程中没有任何提示性信息。其它还有zip解压文件，读取zip压缩包，悄悄的失败，也没有任何提示，从windows 7 到 windows 11，一直如此。

有两种方法： 第一种是修改组策略中的配置：

“运行”中输入gpedit.msc，然后选择“用户配置”-“管理模板”-“Windows组件”-“附件管理器”。

    1.文件附件值中不保留区域信息，设置为“启用” （光这步就够了）

    2.文件类型的默认风险级别，设置为“启用”，“低风险”。
    3.低风险文件类型的包含列表，设置为“启用”，扩展名增加比如：.docx;.doc;.xls;.xlsx

第二种是增加一个全局的环境变量SEE_MASK_NOZONECHECKS，设置值为1.

        [HKEY_CURRENT_USER \Environment]
        SEE_MASK_NOZONECHECKS = "1"

### 打开任务栏毛玻璃效果

HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Advanced
新建 dword值 UseOLEDTaskbarTransparency 为 1

### 显示器在Win10开启HDR变灰泛白的原因找到了

在游戏或播放软件里单独设置HDR选项就可以了，windows系统不需要打开HDR选项，目前的 windows 10 并没有很好的适配HDR显示器。

原因很简单, 你的显示器并不真正提供HDR显示(OLED/FALD), 而Windows还没有对Display HDR400和600这两个"假HDR"提供支持.

Windows现在的偏灰, 是在输出HDR信号的情况下自动降低UI亮度的被Display HDR400误显示的结果. 这些显示器的HDR并没有低亮度细节, 所以低亮度部分就发灰了.HDR和暗部平衡差不多，都可以把暗部系列显示出来，所以看起来就像是亮度调得很高的样子，会泛白.

这个问题在FALD/OLED显示器上是不存在的. 仅在Display HDR400-600的"假HDR"显示器上存在.

简单来说就是为了支持桌面HDR软件App, 桌面必须声明需求显示器的完整HDR亮度范围. 然而显然桌面UI本身不能闪瞎人眼, 所以桌面UI的亮度是低亮度模式. Display HDR400-600的显示器并不能显示完整的HDR内容, 自然这种为真HDR设计的模式就会出现显示错误.

因为其实问题是Display HDR400-600并不是真的支持HDR, 亮度范围根本没那么大, 现有的协议并没有体现出这一点微软也没辙, 属于技术局限, 只能等未来看微软打算怎么解决这个问题了.

最好是显示器厂商单独出HDR配置文件, 让Windows自动识别实际的HDR亮度范围, 而不是接收显示器现在汇报的这个虚假的HDR亮度范围.

现在的HDR标准其实是纯凑活事的, 信号输出了剩下的全看显示器, 导致HDR内容的显示没有任何标准, 大家效果千差万别. 这在真HDR显示器上也很明显, 不同品牌的FALD显示器效果也是完全不同的. 颜色亮度各种跑偏. 完全是群魔乱舞.

很多游戏内置HDR选项, 让你单独调节亮度来适应屏幕就是这个原因.

### 为Windows 10 Enterprise LTSC增加应用商店

<https://github.com/kkkgo/LTSC-Add-MicrosoftStore>

要开始安装, 请打包下载LTSC-Add-MicrosoftStore-2019.zip后用右键管理员运行 Add-Store.cmd

如果您不想安装App Installer / Purchase App / Xbox，请在运行安装之前删除对应的.appxbundle后缀的文件。但是，如果您计划安装游戏，或带有购买选项的应用，则不要删除。

如果装完之后商店仍然打不开，请先重启试试。如果仍然不行，请以管理员身份打开命令提示符并运行以下命令之后，然后再重启试试。
PowerShell -ExecutionPolicy Unrestricted -Command "& {$manifest = (Get-AppxPackage Microsoft.WindowsStore).InstallLocation + '\AppxManifest.xml' ; Add-AppxPackage -DisableDevelopmentMode -Register $manifest}"

商店修复
Win+R打开运行，输入WSReset.exe回车。
该命令会清空并重置Windows Store商店的所有缓存。

该脚本由abbodi1406贡献：
<https://forums.mydigitallife.net/threads/add-store-to-windows-10-enterprise-ltsc-LTSC.70741/page-30#post-1468779>

### Win10安装Ubuntu子系统超详细攻略

    win10+ubuntu双系统见<https://www.cnblogs.com/masbay/p/10745170.html>

1.首先点击开始，然后点击设置

2.选择更新和安全

3.在左边点击开发者选项

4.点击开发人员模式

5.会出现正在安装开发人员模式程序包

6.稍等片刻，大概2分钟左右就可以安装成功

7.然后返回，点击应用

8.在应用和功能界面，选择程序和功能

9.点击启用或关闭windows功能

10.弹出的窗口中拉到最下面，勾选上适用于Linux的Windows子系统

11.然后会自动安装所需要的库

12.大约5秒，安装完毕后需要重启电脑

13.重启电脑后并没有安装linux系统，还需要输入lxrun /install /y来进行系统的下载 （win10 2020版已经启用此命令）

13.在windows搜索框中输入网址 <https://aka.ms/wslstore> ，然后回车，之后会先打开edge浏览器，然后自动跳转到win10应用商店。
打开微软商店应用，在搜索框中输入“Linux”然后搜索，选择一个你喜欢的 Linux 发行版本然后安装。

14.然后会弹出一个shell窗口，正在安装。

15.安装完会提示输入用户名和密码，输入自己的就可以。

16.然后安装完成后点击打开，等待启动

17.初次使用ubuntu

打开cmd，输入bash。

输入sudo apt update检测更新

输入sudo apt install sl安装小火车

输入sl出现火车，说明安装成功

最后要说明的一点是，这个系统是安装在C:\Users\%user_name%\AppData\Local\lxss中的，所以会占用c盘的空间，所以最好把数据之类的都保存在其他盘中，这样不至于使c盘急剧膨胀。

## 安全的使用你的手机

安卓系统权限管理的google官方说明

    <https://developer.android.google.cn/guide/topics/permissions/overview?hl=zh-cn>

安卓系统应用程序对用户数据发送给第三方的现状
    <https://zhuanlan.zhihu.com/p/397453757>

### 安全使用的背景

手机app出于各种目的，非必要获取用户的设备甚至通话联系人，用户使用应用程序的记录，甚至扫描硬盘读取用户数据，必须屏蔽。
安卓的权限是归类的，app需要一个权限，其实开通的是一个类别的全部权限，有哪个app明确向你解释它到底读了些啥，又发给了谁。

如果在安卓系统的权限提示中选择禁用，有些比较下作的软件，比如微信QQ等直接不能使用。

安卓系统的权限提示，有些无法选择动态使用（真用到的时候提示）。比如你使用时给了某个app存储照片时访问系统根目录的许可，但是这个app过会儿自己在后台扫描系统目录，你能得到任何提示吗？它的联网上传功能默认都是放开的，所以……。

### 一个腐烂的例子

你花钱买的东西，使用起来要听某米公司的安排，你能接受吗

    某米手机，之前已经安装使用的app，当前被应用商店下架，比如某打车软件，你现在是否还能点开运行？由某米公司直接禁止用户使用自己的手机，这个你怎么解决？你家买的某米智能家电，他要是给你禁用了，你咋办？某米的产品在各种位置弹出广告，你能选择一键关闭全部广告吗？某米的智能家电，除了他告诉你的记录功能，如果在后台悄悄的记录你的谈话、行动轨迹，他会告诉你吗？这样明显的侵犯用户个人权利，请问如何解决落实？

### 如果有人觉得苹果手机安全

苹果总裁能拒绝米国司法机关要求，不解锁毒贩子的iphone。注意这种操作仅限于对米国人，人家跟钱没仇，其它国家要求啥就是啥，赚钱就行。

苹果非常配合各国市场的不同国情，r国的苹果和米国的苹果其实是完全不一样的：前几天，r国苹果下线了反对派的某软件，据说又上线了一个该国国家机构的同款软件（疑似钓鱼），不知道r国反对派那些政党咋办。请自行搜索如下新闻：

    2021年09月17日 俄罗斯的"Smart Voting"选举应用程序已从App Store和Google Play中删除，反对派发言人称这是"政治审查"。在俄罗斯要求苹果和Google删除该应用程序，然后威胁罚款之后，苹果和Google已经在该国下架了这一应用程序。
    <https://new.qq.com/rain/a/20210918a00gc400>
    <https://www.cnbeta.com/articles/tech/1180405.htm>

### 沙箱运行

google自称安卓app都是在java沙箱运行，但是留足了系统接口，应用可以经权限申请，读取整个系统的任意信息。这样跟没限制啥区别？
安卓操作系统是开源的，如果手机厂商深度修改了安卓的权限控制，用户怎么知道？ 人家卖广告数据赚钱的，都是走后台。

### 某些山寨机，深度修改安卓系统的权限申请控制

有些权限比如读取应用列表等，根本不会在用户界面给出提示，摆明了给某些特殊app比如广告程序调用，详见下面“验证方法”章节的java代码。

### 虚拟机套娃用法

目前看，可以正常使用手机各项功能，又能够限制app乱读取发送用户数据，甚至越界操作用户软件的办法，只能是在当前的手机系统（宿主机）上再运行个虚拟机系统，这个虚拟机系统完整照搬当前手机的原始安卓系统状态，软件系统和数据都是原始系统的，就像一个新买的手机系统。把app装到这个虚拟机系统的安卓里，这样它无法越界到宿主机，读取甚至控制宿主机的应用程序。重点就是虚拟机内运行的app，看不到外部的应用、应用列表、数据等。

三星：

    使用三星knox技术的“安全文件夹”，把app添加到“安全文件夹”，就可以在单独的虚拟系统运行了，理论上是把手机出厂的安卓系统单独克隆了一份，用户后来安装的app不会被克隆进去，这个虚拟机就是个刚买的新手机状态。三星的本意是把需要保密的app装到“安全文件夹”里运行，鉴于当前安卓app的混乱情况，只能倒用：把不安全的app装到这个“安全文件夹”里，让他对着一份干净的安卓系统随意折腾去吧。使用“安全文件夹”运行app的好处还有，在这个虚拟机系统内安装的app想要读取硬件或联系人短信等信息是可以的，但权限由“安全文件夹”赋予，app自己不可以修改。

    也就是说，假定，google的安卓系统是照顾到用户个人权利，进行权限控制是可信的。三星手机的安卓系统是老老实实按照google的安卓系统要求开发实现的，并没有把权限控制等功能变成用户无感知，那么三星手机的安卓系统也是可信的。那么再次基础上的三星“安全文件夹”进行的权限控制，也是可信的。在“安全文件夹”内部运行的程序，都受到“安全文件夹”权限控制的管理，适时在用户界面给出提示也是可以接受的。 需要注意的是三星手机的应用程序节能策略，这个是全局的，“安全文件夹”内的app，也是可以深度休眠不乱发系统通知的。

    knox 原理介绍 <https://zhuanlan.zhihu.com/p/66659414>
    <https://www.v2ex.com/t/377512>

安卓虚拟机：

    <https://www.jianshu.com/p/84127032d15a> 这个提到如何虚拟运行安卓app，并检查它到底使用了啥权限
        <https://github.com/android-hacker/VirtualXposed>
        <https://github.com/sgl890226/HookLoginDemo>

    TODO: 自己写个申请各种权限的app，装到手机里挨个检查。

### 验证方法

安装腾讯手机版QQ，点击头像，在弹出菜单选择“我的文件”，选择“手机文件”，在弹出界面进行如下检查：

    选择“图片”，是否只列出了虚拟系统内你保存的图片，而不是你的手机系统的全部图片

    选择“应用”，确认读取应用列表权限，是否只列出了虚拟系统内安装的app，而不是你的手机系统内的安装的app

    选择底部的“全部（手机内存/SD卡）”，是否只列出了虚拟系统的文件夹结构和文件，而不是你的手机系统的文件夹结构和文件

Android中无需权限获取应用程序列表

``` java
    // https://bbs.pediy.com/thread-256968.htm
    // getInstalledPackages这个函数在很多手机上面是要权限的，我的方法不用任何权限。
    // 我刚刚也去查看了Android的源代码，确实有权限控制，但是这个权限是很多手机默认就给了的。
    // 除非有一些手机，默认就不给，或者用户根本就不给这个权限，这个时候肯定获取不到。这个代码就是为了绕过这部分机器的限制做的。
    // 经过我自己的实验,华为三星等手机没有任何问题.在9.0的系统上面也没有问题，10.0的我没有手机，如果哪位有也客户测试一些。简单的跟大家分享一下我的研究成果.
    //
    //千秋事佐闲茶 活跃值 2019-12-30 15:49
    //   非某些国产手机，获取应用列表本来就不需要权限
    // sunzhanwei 2019-12-30 15:52
    //   我测试过了，某米手机不需要，但是华为，三星等是需要的，主要针对需要权限的手机，不需要权限的无所谓。
    //
    // 参考
    //      https://www.jianshu.com/p/dee8bc1fb847
    //      https://blog.csdn.net/q384415054/article/details/72972405
    //      https://blog.csdn.net/qq_40315080/article/details/96853966

    private void getPackageList(Context ctx) {

        Log.d("TAG", "无需权限获取应用列表");
        PackageManager pkgMgr = ctx.getPackageManager();
        String[] pkgs = null;
        int uid = 1000;

        while (uid <= 19999) {
            pkgs = pkgMgr.getPackagesForUid(uid);
            if (pkgs != null && pkgs.length > 0) {
                for (String pkg : pkgs) {

                    try {
                        final PackageInfo pkginfo = pkgMgr.getPackageInfo(pkg, 0);
                        if (pkginfo == null) {
                            break;
                        }

                        CharSequence name = pkgMgr.getApplicationLabel(pkgMgr.getApplicationInfo(pkginfo.packageName, PackageManager.GET_META_DATA));

                        Log.d("TAG", "应用名称 = " + name.toString() + " (" + pkginfo.packageName + ")");

                    } catch (PackageManager.NameNotFoundException e) {
                        e.printStackTrace();
                    }
                }
            }
            uid++;
        }
    }
```
